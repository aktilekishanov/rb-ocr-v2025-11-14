{"Model":"gpt-4o","Content":"You are a deterministic OCR document-type classifier.\nAnalyze the OCR text and output ONLY the following JSON object (no extra text):\n{\n  \"single_doc_type\": true | false,\n  \"confidence: number [0...100]\",\n  \"detected_doc_types\": [ \"...\" ],\n  \"reasoning\": \"...\"\n  \"doc_type_known\": true | false\n}\nNo extra text or commentary outside the JSON.\n\nSemantics:\n- detected_doc_types: canonicalized titles (best-first). If none, output an empty array.\n- single_doc_type: if detected_doc_types contains =\u003c 1 type → true, otherwise → false.\n- doc_type_known: true ONLY if the top candidate is in the following Dictionary; false for unknown/ambiguous types.\n- confidence: coarse confidence for the top candidate (diagnostics only; do not derive doc_type_known from it).\n- reasoning: brief explanation for the decision.\n\n---\n\n## CLASSIFICATION ALGORITHM (strict order)\n\n### 1. Noise Filtering\n\nIgnore any of the following — they NEVER create new document types:\n* OCR artifacts, partial English words, mixed-language fragments\n* Dates, form numbers, signatures, translations, page numbers, headers/footers\n* Repetitions of the same title in another language (e.g. Kazakh ↔ Russian)\n\n### 2. Candidate Title Detection\n\nSearch the **first 15 non-empty lines** for possible document titles.\nA line is a title if it contains or resembles words like:\n**ПРИКАЗ, СПРАВКА, ЛИСТ, ВЫПИСКА, ЗАКЛЮЧЕНИЕ, УВЕДОМЛЕНИЕ**\nor their Kazakh equivalents (**БҰЙРЫҚ, АНЫҚТАМА, ХАТТАМА, ХАБАРЛАМА**).\n\n### 3. Canonical Document Types (reference list)\n\nFuzzy-match (Levenshtein ≥ 0.8) each candidate title to one of these canonical types from Dictionary:\n1. Лист временной нетрудоспособности (больничный лист)\n2. Приказ о выходе в декретный отпуск по уходу за ребенком\n3. Справка о выходе в декретный отпуск по уходу за ребенком\n4. Выписка из стационара (выписной эпикриз)\n5. Больничный лист на сопровождающего (если предусмотрено)\n6. Заключение врачебно-консультативной комиссии (ВКК)\n7. Справка об инвалидности\n8. Справка о степени утраты общей трудоспособности\n9. Приказ о расторжении трудового договора\n10. Справка о расторжении трудового договора\n11. Справка о регистрации в качестве безработного\n12. Приказ работодателя о предоставлении отпуска без сохранения заработной платы\n13. Справка о неполучении доходов\n14. Уведомление о регистрации в качестве лица, ищущего работу\n15. Лица, зарегистрированные в качестве безработных\n\nNOTE:\n**Important semantic aliases (normalize these as identical):**\n* \"о предоставлении отпуска по уходу за ребенком\"\n* \"о выходе в декретный отпуск по уходу за ребенком\"\n* \"о предоставлении декретного отпуска\"\n* \"Бала күтіміне байланысты жалақысы сақталмайтын демалыстар беру туралы\"\n\nAll refer to canonical type either:\n**Приказ о выходе в декретный отпуск по уходу за ребенком**\nOR\n**Справка о выходе в декретный отпуск по уходу за ребенком**\n\n### 4. Normalization\n\nMerge duplicates, translations, or paraphrases describing the same purpose.\nIf all detected titles are linguistic variants or synonyms of one canonical type → treat as **one** document → `single_doc_type = true`.\n\n### 5. Distinct Document Detection\nIf two or more **different canonical types** are present (e.g. \"Приказ о расторжении трудового договора\" and \"Справка о расторжении трудового договора\") → `single_doc_type = false`.\nBefore declaring \"multiple types,\" confirm that they represent **different legal purposes**, not wording variants or translations.\n\n### 6. Issuer Check\n\nIf the text shows clearly unrelated issuers (different organizations or ministries), and each is tied to a distinct canonical type → `single_doc_type = false`.\nOtherwise, ignore repeated issuer mentions.\n\n### 7. Default Safety\n\n- If uncertain, noisy, or ambiguous → default to\n{\n\"single_doc_type\": true,\n\"detected_doc_types\": [...]\n}\n- If confidence is \u003c 90 →\n{\n\"single_doc_type\": true,\n\"detected_doc_types\": [...]\n}\n\n---\n\n### 8. Output Rules\n\n* Return **exactly one** valid JSON object.\n* Do **NOT** include markdown formatting, code fences, explanations.\n* Do **NOT** include ```json formatting\n* JSON keys and string values must be enclosed in double quotes.\n\n---\n\n### TEXT FOR ANALYSIS\n{\"pages\": [{\"page_number\": 1, \"text\": \"ат электрондық үкімет порталымен ылған Бірегей нөмі\\nе. О Құж трондық ү P KER P uP 101000188887820\\nДокумент сформирован порталом электронного правительства Уникальный номер\\nАлу күні\\n24.11.2025\\nДата получения\\nСПРАВКА О РЕГИСТРАЦИИ В КАЧЕСТВЕ\\nБЕЗРАБОТНОГО\\nДана ЖАНСЕЙТОВА ЛАУРА ЖАМБЫЛКЫЗЫ в том что он(а) в\\nсоответствии со статьей 14 Закона Республики Казахстан «О занятости\\nнаселения» зарегистрирован (а) в Г.АЛМАТЫ КАРЬЕРНЫЙ ЦЕНТР с\\n12.05.2025 года.\\nСправка действительна в течение 30 (тридцати) календарных дней.\\nДата выдачи: 24.11.2025 года.\\nДиректор центра: ПОРТАЛ ЕНБЕК\\nОсы құжат \\\"Электрондық құжат және электрондық цифрлық қолтаңба туралы \\\" Қазақстан Республикасының 2003 жылғы 7 қаңтардағы М 370-П Заңы 7 бабының 1 тармағына сәйкес\\nқағаз тасығыштағы құжатпен бірдей.\\nДанный документ согласно пункту 1 статьи 7 ЗРК от 7 января 2003 года «Об электронном документе и электронной цифровой подписи» равнозначен документу на бумажном носителе.\\nж Штрих-код ЭРНБ ақпараттық жүйесінен алынған Әділет департаментінің электрондық-цифрлық қолтаңбасымен қойылған деректер бар.\\nж Штрих-код содержит данные, полученные из информационной системы ЭРНБ и подписанные электронно-цифровой подписью M3 РК Стр. 1 из1\\nр р y р р р\"}]}\n","Temperature":0,"MaxTokens":500,"response_format":null}
{"choices":[{"finish_reason":"stop","index":0,"logprobs":null,"message":{"annotations":[],"content":"{\n  \"single_doc_type\": true,\n  \"confidence\": 95,\n  \"detected_doc_types\": [\"Справка о регистрации в качестве безработного\"],\n  \"reasoning\": \"The document contains a clear title 'СПРАВКА О РЕГИСТРАЦИИ В КАЧЕСТВЕ БЕЗРАБОТНОГО', which matches a known canonical type.\",\n  \"doc_type_known\": true\n}","refusal":null,"role":"assistant"}}],"created":1764054089,"id":"chatcmpl-CfhLFMgfTYwuxjk93W8zBfs18cDwx","model":"gpt-4o-2024-08-06","object":"chat.completion","service_tier":"default","system_fingerprint":"fp_e819e3438b","usage":{"completion_tokens":94,"completion_tokens_details":{"accepted_prediction_tokens":0,"audio_tokens":0,"reasoning_tokens":0,"rejected_prediction_tokens":0},"prompt_tokens":1528,"prompt_tokens_details":{"audio_tokens":0,"cached_tokens":1408},"total_tokens":1622}}