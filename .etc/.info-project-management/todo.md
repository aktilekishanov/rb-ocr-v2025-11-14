# **План работ по проекту OCR**

## **1. Работа с базой данных (БД)**

1. **Разработать и утвердить схему базы данных**

   * Спроектировать структуру таблиц.
   * Подготовить ER-диаграмму.

2. **Поднять БД на сервере**

   * Сервер: `rb-ocr-dev-pgsql-uv01.fortebank.com`
   * Создать необходимые схемы, таблицы, индексы и ограничения.

3. **Обновить FastAPI: переход на хранение данных в БД**

   * Заменить текущий механизм хранения локальных JSON-файлов.
   * Реализовать слой доступа к данным (CRUD).
   * Обновить эндпоинты на работу через БД.



## **2. Тестирование**

1. **Запуск тестовых заявок бизнеса**

   * На новом сервере: `rb-ocr-dev-app-uv01.fortebank.com/rb-ocr/ui`
   * Проверить корректность работы пайплайна.

2. **Получить акт тестирования №4 от бизнеса**

   * Проанализировать найденные ошибки.
   * Внести исправления в пайплайн обработки (если потребуются).



## **3. Интеграция с Kafka**

1. **Получить URL Kafka-брокера**

   * Уточнить у DevOps / архитекторов.

2. **Уточнить логику взаимодействия с МИБ**

   * Будет ли UI МИБ передавать `document_type`?

3. **Создать новый Kafka-интеграционный эндпоинт в FastAPI**

   * Эндпоинт, принимающий тело сообщения, поступающего из Kafka.

   ### **AS-IS (текущая версия)**

   * Ручная загрузка файла.
   * Ручной ввод ФИО.

   ### **TO-BE (сообщение от Kafka)**

   ```json
   {
     "request_id": 123123,
     "document_type": 4,   // если потребуется (зависит от пункта 2)
     "s3_path": "some_s3_address",
     "iin": 960125000000,
     "first_name": "Иван",
     "last_name": "Иванов",
     "second_name": "Иванович"
   }
   ```

4. **Реализовать S3 File Fetcher**

   * Написать модуль скачивания файла по `s3_path`.
   * Интегрировать в новый эндпоинт.
   * Добавить в пайплайн распознавания.



## **4. REST API взаимодействие с МИБ**

1. **Уточнить формат передачи результатов обработки**

   * Какой эндпоинт будет принимать результат.
   * В каком формате МИБ ожидает input (schema / JSON fields).